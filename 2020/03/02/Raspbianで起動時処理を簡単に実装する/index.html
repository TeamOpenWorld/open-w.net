<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Raspbianで起動時処理を簡単に実装する · MinatoNote</title><meta name="description" content="Raspbianで起動時処理を簡単に実装する - Minato86"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://blog.minato86.me/atom.xml" title="MinatoNote"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="MinatoNote" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.jpeg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://twitter.com/minatoo86" target="_blank" class="nav-list-link">TWITTER</a></li><li class="nav-list-item"><a href="https://minato86.me/" target="_blank" class="nav-list-link">PORTFOLIO</a></li><li class="nav-list-item"><a href="https://github.com/Chipsnet" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Raspbianで起動時処理を簡単に実装する</h1><div class="post-info">Mar 2, 2020</div><div class="post-content"><p>私、めんどくさいのが大嫌いなので、超簡単に起動時処理を実装します。</p>
<p>ほとんどの記事ではlocal.rcで実装してたんですが、rootで実行されるのとうまくいかなかったので今回はcronで実装します。</p>
<h2 id="raspi-configの設定"><a href="#raspi-configの設定" class="headerlink" title="raspi-configの設定"></a>raspi-configの設定</h2><p>まずは、ネットが接続されるまで処理を待つ設定をします。</p>
<p>（これをしないと正常に動作しないときがあるみたい）</p>
<p><a href="https://gyazo.com/56439f0ba30a869d8c1fe7a73a84fb91" target="_blank" rel="noopener"><img src="https://i.gyazo.com/56439f0ba30a869d8c1fe7a73a84fb91.png" alt="Image from Gyazo"></a></p>
<p><code>sudo raspi-config</code>を入力</p>
<p><a href="https://gyazo.com/a948e12d11adbd8f49ad45b2f623b44e" target="_blank" rel="noopener"><img src="https://i.gyazo.com/a948e12d11adbd8f49ad45b2f623b44e.png" alt="Image from Gyazo"></a></p>
<p>Boot Optionsを選択</p>
<p><a href="https://gyazo.com/2413e127a71c44c27d86b1096519ef82" target="_blank" rel="noopener"><img src="https://i.gyazo.com/2413e127a71c44c27d86b1096519ef82.png" alt="Image from Gyazo"></a></p>
<p>Wait for Network at Bootを選択</p>
<p><a href="https://gyazo.com/98b1ab3d7834ed281b4442edf8779717" target="_blank" rel="noopener"><img src="https://i.gyazo.com/98b1ab3d7834ed281b4442edf8779717.png" alt="Image from Gyazo"></a></p>
<p>はいを選択</p>
<p><a href="https://gyazo.com/96f182577ba2f6de15e61e110cda42bb" target="_blank" rel="noopener"><img src="https://i.gyazo.com/96f182577ba2f6de15e61e110cda42bb.png" alt="Image from Gyazo"></a></p>
<p>了解を選択</p>
<p>これでOK</p>
<h2 id="crontabのログ設定"><a href="#crontabのログ設定" class="headerlink" title="crontabのログ設定"></a>crontabのログ設定</h2><p>実行されているか確認するために、ログが残るよう設定しましょう。</p>
<p><code>sudo nano /etc/rsyslog.conf</code></p>
<p>でファイルを開き</p>
<p><code>#cron.* /var/log/cron.log</code></p>
<p>と書いてある行を見つけて、#を外します（コメントアウト）</p>
<p><code>cron.* /var/log/cron.log</code></p>
<p>あとはCtrl+Xを押して、保存するか聞かれるのでyを押す。<br>終わったらログの設定は完了です。</p>
<h2 id="crontabの設定"><a href="#crontabの設定" class="headerlink" title="crontabの設定"></a>crontabの設定</h2><p>crontabには@rebootという、起動時に処理されるトリガがあり、今回はこれを利用していきます。<br>raspbianには標準で備わっているので、利用していきましょう。</p>
<p><code>crontab -e</code>で編集します。</p>
<p>初回はどのエディタを使うか確認されます。nanoでよければEnterを、他がよければ数字で選択してください。<br>（私はnano使いなのでそのままEnter）</p>
<p>そしたら、nanoが起動して編集可能になるので、一番下に<code>@reboot [実行したいコマンド]</code>を追記してください。<br>今回はVNCサーバーが起動時に立ち上がるようにしたかったので、<code>@reboot vncserver -localhost no</code>を追記しました。</p>
<p>そしたら保存して、<code>crontab -l</code>で今入力した内容があるかを確認してください。</p>
<h2 id="再起動"><a href="#再起動" class="headerlink" title="再起動"></a>再起動</h2><p>再起動して実行されていればOK。</p>
<h2 id="実行されていなかった場合"><a href="#実行されていなかった場合" class="headerlink" title="実行されていなかった場合"></a>実行されていなかった場合</h2><p>しっかりcrontabが動いているかはログで確認できます。</p>
<p><code>sudo cat /var/log/cron.log</code>を確認して、エラーだったり、入力したコマンドがないようでしたら検索してみてください。</p>
<p>こんな感じで簡単に実装できました。やったぜ。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2020/03/03/lubuntu-19-10-LXQt%E3%81%ABVNC%E3%81%A7%E6%8E%A5%E7%B6%9A%E3%81%99%E3%82%8B/" class="prev">NEXT</a><a href="/2020/03/02/%E3%82%A6%E3%83%81%E3%81%AEWifi%E3%81%8C%E7%95%B0%E6%A7%98%E3%81%AE%E9%81%85%E3%81%84%E3%81%AE%E3%81%A7%E3%81%A9%E3%81%86%E3%81%AB%E3%81%8B%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B/" class="next">PREV</a></div><div class="copyright"><p>© 2015 - 2020 <a href="https://blog.minato86.me">Minato86</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>